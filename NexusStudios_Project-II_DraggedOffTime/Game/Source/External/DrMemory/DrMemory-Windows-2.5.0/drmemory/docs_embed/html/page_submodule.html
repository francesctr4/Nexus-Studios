---
title: "Updating the DynamoRIO Submodule"
layout: default
permalink: /page_submodule.html
---
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dr. Memory
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Updating the DynamoRIO Submodule </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md18"></a>
DynamoRIO Inside Dr. Memory</h1>
<p>DynamoRIO is included inside the Dr. Memory source tree as a <a href="http://git-scm.com/docs/git-submodule">git submodule</a>. We support both building that embedded DR along with pointing to an already-built separate DR export tree.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Submodule Rollback</h1>
<p>Be careful with submodules when pulling upstream changes. If a submodule was modified upstream and only a <code>git pull</code> is run without a subsequent <code>git submodule update</code>, that upstream change will be reverted upon the next <code>git push</code>. Please use the <code>pullall</code> alias to avoid accidentally clobbering submodule changes.</p>
<p>We do have a pre-commit hook in place that will warn you if you try to roll back the dynamorio submodule while checking in at least one other file:</p>
<div class="fragment"><div class="line">% git commit -a</div>
<div class="line">Error: the dynamorio submodule is being rolled back.</div>
<div class="line">This is likely a mistake: did you pull but not run git submodule update?</div>
<div class="line">Aborting commit.</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20"></a>
Updating the DynamoRIO Version</h1>
<p>Run <code>git checkout &lt;hash&gt;</code> to update DynamoRIO to that hash:</p>
<div class="fragment"><div class="line">cd dynamorio</div>
<div class="line">git pull</div>
<div class="line">git checkout 0c81acfc9aaea949e6f6ecfe0b4157c06a014dda</div>
</div><!-- fragment --><p>If Dr. Memory's sources are being changed to require this new version of DR, apply the Dr. Memory changes such that they will be included in the same commit that updates the submodule version. Also add to the commit message something like "Relies on DR &lt;hash&gt;.  Updates DR to &lt;hash&gt;.".</p>
<p>If Dr. Memory won't build, or shouldn't be built, with any older version of DR, also update the set of the "DynamoRIO_VERSION_REQUIRED" variable in trunk/CMakeLists.txt (use the patchlevel printed by <code>cmake .</code>).</p>
<p>Now run the Dr. Memory test suite <b>with an embedded DR, not with an already-built DR</b> to ensure it's happy with the updated DR.</p>
<p>In your commit log message state to which version you're updating DR, and why (typically to pull in a certain bug fix or new feature). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.19-->
<!-- start footer part -->
<!--BEGIN GENERATE_TREEVIEW-->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer" style="float:none;text-align:center"><img border=0 src="favicon.png"> &nbsp;  Dr. Memory version 2.5.0 --- Mon Oct 18 2021 03:09:18 &nbsp; <img border=0 src="favicon.png">
</small></address>
